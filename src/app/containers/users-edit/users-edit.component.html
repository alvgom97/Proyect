<h2 id="title">Editar Usuario</h2>

<mat-list *ngIf="user">
    <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
        <mat-accordion>

            <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Datos Personales:
                    </mat-panel-title>
                </mat-expansion-panel-header>

                <mat-form-field appearance="legacy">
                    <mat-label>Nombre:</mat-label>
                    <input matInput placeholder="Álvaro" [formControl]="firstName" required />
                    <mat-error *ngIf="firstName.invalid">{{getErrorMessage(firstName)}}</mat-error>
                </mat-form-field>

                <mat-form-field appearance="legacy">
                    <mat-label>Primer apellido:</mat-label>
                    <input matInput placeholder="Gómez" [formControl]="lastName" required />
                    <mat-error *ngIf="lastName.invalid">{{getErrorMessage(lastName)}}</mat-error>
                </mat-form-field>

                <mat-form-field appearance="legacy">
                    <mat-label>Segundo apellido:</mat-label>
                    <input matInput placeholder="Martín" [formControl]="secondLastName" />
                    <mat-error *ngIf="secondLastName.invalid">{{getErrorMessage(secondLastName)}}</mat-error>
                </mat-form-field>

                <mat-form-field appearance="legacy">
                    <mat-label>Género:</mat-label>
                    <mat-select name="gender" [formControl]="gender">
                        <mat-option value="Mujer">Mujer</mat-option>
                        <mat-option value="Hombre">Hombre</mat-option>
                        <mat-option value="No Binario">No Binario</mat-option>
                    </mat-select>
                </mat-form-field>

                <mat-form-field appearance="legacy">
                    <mat-label>Fecha de Nacimiento:</mat-label>
                    <input matInput placeholder="04/05/1997" [formControl]="birthdate" required />
                    <mat-error *ngIf="birthdate.invalid">{{getErrorMessage(birthdate)}}</mat-error>
                </mat-form-field>

                <mat-form-field appearance="legacy">
                    <mat-label>Num de Identificación:</mat-label>
                    <input matInput placeholder="12345678Z" [formControl]="identityNumber" />
                    <mat-error *ngIf="identityNumber.invalid">{{getErrorMessage(identityNumber)}}</mat-error>
                </mat-form-field>

                <mat-form-field appearance="legacy">
                    <mat-label>Num de Historial Clínico:</mat-label>
                    <input matInput placeholder="9876543210" [formControl]="nhc" required />
                    <mat-error *ngIf="nhc.invalid">{{getErrorMessage(nhc)}}</mat-error>
                </mat-form-field>

            </mat-expansion-panel>

            <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Dirección:
                    </mat-panel-title>
                </mat-expansion-panel-header>

                <mat-form-field appearance="fill">
                    <mat-label>Calle:</mat-label>
                    <input matInput placeholder="Calle Mayor" [formControl]="street" required />
                    <mat-error *ngIf="street.invalid">{{getErrorMessage(street)}}</mat-error>
                </mat-form-field>

                <mat-form-field appearance="fill">
                    <mat-label>Número:</mat-label>
                    <input matInput placeholder="14" [formControl]="number" required />
                    <mat-error *ngIf="number.invalid">{{getErrorMessage(number)}}</mat-error>
                </mat-form-field>

                <mat-form-field appearance="fill">
                    <mat-label>Puerta:</mat-label>
                    <input matInput placeholder="4ºD" [formControl]="door" required />
                    <mat-error *ngIf="door.invalid">{{getErrorMessage(door)}}</mat-error>
                </mat-form-field>

                <mat-form-field appearance="fill">
                    <mat-label>Código Postal:</mat-label>
                    <input matInput placeholder="28922" [formControl]="postalCode" required />
                    <mat-error *ngIf="postalCode.invalid">{{getErrorMessage(postalCode)}}</mat-error>
                </mat-form-field>

                <mat-form-field appearance="fill">
                    <mat-label>Ciudad:</mat-label>
                    <input matInput placeholder="Alcorcón" [formControl]="city" required />
                    <mat-error *ngIf="city.invalid">{{getErrorMessage(city)}}</mat-error>
                </mat-form-field>
            </mat-expansion-panel>

            <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Aseguradoras:
                    </mat-panel-title>
                </mat-expansion-panel-header>
                <mat-expansion-panel *ngFor="let i of user?.issuranceList" (opened)="panelOpenState = true"
                    (closed)="panelOpenState = false">
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            {{i?.name}}
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <mat-list-item>Número de Tarjeta: {{i?.cardNumber}}</mat-list-item>
                    <mat-list-item>Tipo: {{i?.type}}</mat-list-item>
                </mat-expansion-panel>
            </mat-expansion-panel>
        </mat-accordion>

        <div id="options">
            <button mat-fab color="primary" routerLink='/users/{{user.id}}' ><mat-icon>keyboard_arrow_left</mat-icon></button>
            <button mat-fab color="primary" ><mat-icon>delete_forever</mat-icon></button>
            <button mat-fab type="submit" color="primary" ><mat-icon>send</mat-icon></button>
          <!-- [disabled]="!profileFormProf.valid" -->
          </div>

    </form>
</mat-list>